'''
Created on Apr 22, 2016

@author: neil
'''
import sqlite3

# New database in memory and a tables to hold the EONet events and the tweets.
db = sqlite3.connect(':memory:')
cursor = db.cursor()

#cursor.execute('''
#    CREATE TABLE EONetEvent(
#        eonet_id VARCHAR(20) PRIMARY KEY,
#        title VARCHAR(50)
#    )''')

cursor.execute('''
    CREATE TABLE Tweet(
        tweet_id INTEGER PRIMARY KEY,
        eonet_id VARCHAR(20),
        name VARCHAR(50),
        createDate DATETIME,
        place VARCHAR(50),
        text VARCHAR(140),
        latitude FLOAT,
        longitute FLOAT
    )''')

db.commit()

def add_tweet(tweet):
    '''Add a tweet to the database.'''
    cursor = db.cursor()
    name = 'Joe'
    createDate = '2016-04-20 00:00'
    place = None
    text = 'This is the first tweet'
    longitude = 117.2
    latitude = 30.2
    cursor.execute('''
        INSERT INTO Tweet(name, createDate, place, text, longitude, latitude)
        VALUES(?, ?, ?, ?, ?, ?)
    ''', (name, createDate, place, text, longitude, latitude))
    db.commit()
    